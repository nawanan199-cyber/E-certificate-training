
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Certificate Checker</title>
<style>
/* ---------------------------------
   BASE STYLES (à¸ªà¸³à¸«à¸£à¸±à¸š PC/Default)
   --------------------------------- */
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin:0; padding:10px; background-color:#F9FBE7; color:#333; } 
/* â­ Container: à¹€à¸à¸´à¹ˆà¸¡à¸„à¸§à¸²à¸¡à¹‚à¸„à¹‰à¸‡à¸¡à¸™à¹€à¸›à¹‡à¸™ 25px à¹à¸¥à¸°à¹€à¸‡à¸²à¹ƒà¸«à¹‰à¸”à¸¹à¸™à¸¸à¹ˆà¸¡à¸™à¸§à¸¥à¸‚à¸¶à¹‰à¸™ â­ */
.container { 
    max-width:800px; 
    margin:0 auto; 
    background-color:#fff; 
    padding:30px 25px; /* à¹€à¸à¸´à¹ˆà¸¡ Padding à¸£à¸­à¸šà¸”à¹‰à¸²à¸™ */
    border-radius:25px; 
    box-shadow:0 8px 20px rgba(0,0,0,0.08); /* à¹€à¸‡à¸²à¸­à¹ˆà¸­à¸™à¸¥à¸‡à¹à¸¥à¸°à¸Ÿà¸¸à¹‰à¸‡à¸‚à¸¶à¹‰à¸™ */
} 

.header-section { display:flex; align-items:center; justify-content:center; flex-direction:column; margin-bottom:10px; } 

.mascot-container { margin-bottom:5px; padding-bottom:0px; }
.mascot-img { width:120px; height:120px; border-radius:50%; border:4px solid #4CAF50; box-shadow:0 4px 8px rgba(0,0,0,0.1); object-fit:cover; }

/* PC: Header Size 32px */
.header { 
    text-align:center; 
    color:#2E7D32; 
    font-size:32px; 
    font-weight:800; 
    border-bottom:3px solid #4CAF50; 
    padding-bottom:8px; /* à¸›à¸£à¸±à¸š Padding à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡ */
    width:100%; 
    max-width:350px; 
} 

/* PC: Search Area Width 300px (à¹à¸„à¸šà¸¥à¸‡) */
.search-area { max-width: 300px; margin: 25px auto 15px auto; /* à¹€à¸à¸´à¹ˆà¸¡à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸”à¹‰à¸²à¸™à¸šà¸™ */ } 

.search-bar { display:flex; gap:10px; } 
/* Search Input: à¸„à¸§à¸²à¸¡à¹‚à¸„à¹‰à¸‡à¸¡à¸™ 12px */
.search-input { flex-grow:1; padding:12px 15px; border:1px solid #ccc; border-radius:12px; font-size:16px; transition:border-color 0.3s; } 
.search-input:focus { border-color:#4CAF50; }
/* Search Button: à¸„à¸§à¸²à¸¡à¹‚à¸„à¹‰à¸‡à¸¡à¸™ 12px */
.search-button { background-color:#4CAF50; color:white; padding:12px 20px; border:none; border-radius:12px; cursor:pointer; font-size:16px; font-weight:bold; transition: background-color 0.3s, box-shadow 0.3s; } 
.search-button:hover { background-color:#388E3C; box-shadow:0 4px 8px rgba(0,0,0,0.2); }

/* à¸ªà¹„à¸•à¸¥à¹Œà¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸²à¸£à¸²à¸‡à¹à¸¥à¸°à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¸¢à¸±à¸‡à¸„à¸‡à¹€à¸”à¸´à¸¡ */
.result-name { background-color:#E8F5E9; padding:18px; margin-bottom:25px; border-radius:12px; font-weight:bold; color:#388E3C; border:1px solid #C8E6C9; box-shadow:0 2px 4px rgba(0,0,0,0.05); display:none; }
.alert-message { background-color:#FFE0B2; color:#E65100; padding:15px; margin-top:20px; border-radius:10px; text-align:center; font-weight:bold; display:none; }
.data-table { width:100%; border-collapse:collapse; text-align:left; margin-top:20px; }
.data-table th, .data-table td { padding:15px; border:1px solid #e0e0e0; }
.data-table th { background-color:#f5f5f5; font-weight:bold; color:#495057; }
.data-table tr:nth-child(even) { background-color:#fcfcfc; }
.data-table tr:hover { background-color:#DCEDC8; }
.data-table th:nth-child(3), .data-table td:nth-child(3) { text-align:center; }


/* ğŸ“± MEDIA QUERY (à¸ªà¸³à¸«à¸£à¸±à¸šà¸«à¸™à¹‰à¸²à¸ˆà¸­à¹€à¸¥à¹‡à¸: à¹‚à¸—à¸£à¸¨à¸±à¸à¸—à¹Œà¸¡à¸·à¸­à¸–à¸·à¸­/à¹à¸—à¹‡à¸šà¹€à¸¥à¹‡à¸•) ğŸ“± */
@media (max-width: 768px) {
    .container {
        padding: 25px 15px; /* à¸›à¸£à¸±à¸š Padding à¸¡à¸·à¸­à¸–à¸·à¸­à¹ƒà¸«à¹‰à¹€à¸‚à¹‰à¸²à¸à¸±à¸š PC */
    }
    
    /* Mobile: Header Size 22px */
    .header {
        font-size: 22px; 
        max-width: 250px; 
        padding-bottom: 5px; 
    }

    .header-section {
        margin-bottom: 0px; 
    }
    .mascot-container {
        margin-bottom: 15px; /* à¹€à¸à¸´à¹ˆà¸¡à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¹ƒà¸«à¹‰à¸¡à¸²à¸ªà¸„à¸­à¸•à¸”à¸¹à¸¡à¸µà¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ */
    }

    /* Mobile: à¸šà¸±à¸‡à¸„à¸±à¸šà¹ƒà¸«à¹‰à¸Šà¹ˆà¸­à¸‡à¸à¸£à¸­à¸à¹à¸¥à¸°à¸›à¸¸à¹ˆà¸¡à¸­à¸¢à¸¹à¹ˆà¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡à¸à¸±à¸™ (Column) */
    .search-bar { 
        flex-direction: column; 
        gap: 15px; 
    }
    .search-button {
        width: 100%; 
        padding: 15px 20px;
    }

    /* Mobile: Search Input à¸¡à¸µà¸„à¸§à¸²à¸¡à¹‚à¸„à¹‰à¸‡à¸¡à¸™à¸ªà¸¹à¸‡à¹€à¸«à¸¡à¸·à¸­à¸™à¹ƒà¸™à¸£à¸¹à¸› */
    .search-input {
        padding: 15px 15px;
        font-size: 16px;
        border-radius: 12px;
    }
    .search-area { 
        max-width: 100%; 
        margin: 20px auto 15px auto; 
    }
    .mascot-img {
        width: 100px; 
        height: 100px;
    }
}
</style>
</head>
<body>
<div class="container">
Â  <div class="header-section">
Â  Â  <div class="mascot-container">
Â  Â  Â  <img src="unnamed.jpg" alt="Safety Mascot" class="mascot-img">
Â  Â  </div>
Â  Â  <div class="header">Certificate Checker</div>
Â  </div>

Â  <div class="search-area">
Â  Â  <div class="search-bar">
Â  Â  Â  <input type="text" id="searchInput" class="search-input" placeholder="à¸à¸£à¸­à¸à¸Šà¸·à¹ˆà¸­à¹€à¸•à¹‡à¸¡ à¸«à¸£à¸·à¸­à¸Šà¸·à¹ˆà¸­à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™">
Â  Â  Â  <button id="searchButton" class="search-button">Search</button>
Â  Â  Â  
Â  Â  </div>
Â  Â  <div id="alertMessage" class="alert-message">à¹‚à¸›à¸£à¸”à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸²</div>
Â  </div>

Â  <div id="nameResult" class="result-name"></div>

Â  <div id="certificateTableContainer" style="display:none;">
Â  Â  <table class="data-table">
Â  Â  Â  <thead id="certificateTableHead"></thead>
Â  Â  Â  <tbody id="certificateTableBody"></tbody>
Â  Â  </table>
Â  </div>

Â  <div id="noResult" class="alert-message" style="display:none; background-color:#fffae0; color:#856404; border:1px solid #ffbb00;">
Â  Â  à¹„à¸¡à¹ˆà¸à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸šà¸£à¸±à¸šà¸£à¸­à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸³à¸„à¹‰à¸™à¸«à¸²à¸™à¸µà¹‰
Â  </div>
</div>

<script>
const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxNlEn32LapklxyLvDvbB_Y3Aw3g37f6zON69m27qdvlVgY4paoUSaf8i65BerMRmFq/exec";
// à¸‹à¹ˆà¸­à¸™à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ STATUS à¹à¸¥à¹‰à¸§
const COLUMNS_TO_HIDE = ['no','name','company','no.', 'status']; 

const searchInput = document.getElementById('searchInput');
const searchButton = document.getElementById('searchButton');
const alertMessage = document.getElementById('alertMessage');
const nameResult = document.getElementById('nameResult');
const tableContainer = document.getElementById('certificateTableContainer');
const tableHead = document.getElementById('certificateTableHead');
const tableBody = document.getElementById('certificateTableBody');
const noResult = document.getElementById('noResult');

function hideAllResults(){
Â  alertMessage.style.display='none';
Â  nameResult.style.display='none';
Â  tableContainer.style.display='none';
Â  noResult.style.display='none';
}

async function runSearch(){
Â  hideAllResults();
Â  const query = searchInput.value.trim();
Â  if(!query){ alertMessage.style.display='block'; return; }

Â  try{
Â  Â  const res = await fetch(`${GAS_WEB_APP_URL}?name=${encodeURIComponent(query)}`);
Â  Â  const results = await res.json();

Â  Â  if(results.error){ alertMessage.textContent = results.error; alertMessage.style.display='block'; return; }
Â  Â  if(results.length===0){ noResult.style.display='block'; return; }

Â  Â  const first = results[0];
Â  Â  nameResult.innerHTML = `Name: <strong>${first.NAME || 'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸'}</strong> | Company: <strong>${first.COMPANY || 'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸'}</strong>`;
Â  Â  nameResult.style.display='block';

Â  Â  tableHead.innerHTML='';
Â  Â  tableBody.innerHTML='';
Â  Â  const headers = Object.keys(first);
Â  Â  headers.forEach(h=>{
Â  Â  Â  if(!COLUMNS_TO_HIDE.includes(h.toLowerCase())){
Â  Â  Â  Â  const th = document.createElement('th');
Â  Â  Â  Â  th.textContent = h;
Â  Â  Â  Â  tableHead.appendChild(th);
Â  Â  Â  }
Â  Â  });

Â  Â  results.forEach(row=>{
Â  Â  Â  const tr = document.createElement('tr');
Â  Â  Â  headers.forEach(h=>{
Â  Â  Â  Â  if(!COLUMNS_TO_HIDE.includes(h.toLowerCase())){
Â  Â  Â  Â  Â  const td = document.createElement('td');
Â  Â  Â  Â  Â  let cellValue = row[h] || '';

Â  Â  Â  Â  Â  td.textContent = cellValue;
Â  Â  Â  Â  Â  tr.appendChild(td);
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  tableBody.appendChild(tr);
Â  Â  });

Â  Â  tableContainer.style.display='block';

Â  }catch(err){
Â  Â  alertMessage.textContent='à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥';
Â  Â  alertMessage.style.display='block';
Â  Â  console.error(err);
Â  }
}

searchButton.addEventListener('click', runSearch);
searchInput.addEventListener('keypress', function(e){ if(e.key==='Enter') runSearch(); });
</script>
</body>
</html>