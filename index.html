
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Certificate Checker</title>

<style>

/* ----------------------------------------------------
   BASE STYLES
---------------------------------------------------- */

body { 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
    margin:0; padding:10px; 
    background-color:#F1F8E9; 
    color:#333; 
} 

.container { 
    max-width:350px !important; 
    margin:0 auto; 
    background-color:#fff; 
    padding:20px 18px;        /* ↓ ลดขอบขาว */
    border-radius:28px;
    border: 1px solid #dcdcdc; 
    box-shadow:0 6px 18px rgba(0,0,0,0.08); 
} 

.header-section { 
    text-align:center; 
    margin-bottom:0px; 
} 

.mascot-img { 
    width:130px; 
    height:130px; 
    border-radius:50%; 
    border:4px solid #4CAF50; 
    object-fit:cover; 
}

.header { 
    text-align:center; 
    color:#2E7D32; 
    font-size:34px; 
    font-weight:800; 
    border-bottom:3px solid #4CAF50; 
    padding-bottom:6px; 
    width:100%; 
    margin-top:5px;
    margin-bottom: 15px;     /* ↑ เพื่อให้ช่องหาไม่ติดเกินไป */
}

/* ----------------------------------------------------
   SEARCH AREA
---------------------------------------------------- */

.search-area { 
    max-width: 300px; 
    margin: 0 auto 15px auto; 
} 

.search-bar { display:flex; gap:10px; } 

.search-input { 
    flex-grow:1; 
    padding:12px 15px; 
    border:1px solid #ccc; 
    border-radius:12px; 
    font-size:16px; 
} 

.search-button { 
    background-color:#4CAF50; 
    color:white; 
    padding:12px 20px; 
    border:none; 
    border-radius:12px; 
    font-size:18px;
    font-weight:bold; 
    cursor:pointer; 
} 

/* ----------------------------------------------------
   RESULT BLOCKS
---------------------------------------------------- */

.result-name { 
    background-color:#E8F5E9; 
    padding:10px;  
    margin-bottom:8px; 
    border-radius:10px; 
    font-weight:bold; 
    color:#388E3C; 
    border:1px solid #C8E6C9; 
    display:none; 
}

.alert-message { 
    background-color:#FFE0B2; 
    color:#E65100; 
    padding:12px; 
    margin-top:10px; 
    border-radius:10px; 
    text-align:center; 
    font-weight:bold; 
    display:none; 
}

/* ----------------------------------------------------
   TABLE STYLE — FULL WIDTH + COLOR STRIPE
---------------------------------------------------- */

.data-table { 
    width:100%; 
    border-collapse:collapse; 
    margin-top:10px; 
    border-radius:10px;
    overflow:hidden;
    border:1px solid #e0e0e0;
}

/* หัวตาราง */
.data-table th { 
    background-color:#e0e0e0; 
    padding:8px; 
    font-weight:bold; 
    color:#333; 
}

/* ขยาย Course ให้ใหญ่ขึ้น */
.data-table th:nth-child(1),
.data-table td:nth-child(1) {
    width:45%;
}

/* ลด Duration */
.data-table th:nth-child(2),
.data-table td:nth-child(2) {
    width:20%;
}

/* ช่องอื่นอิสระ */
.data-table td { 
    padding:8px 10px; 
    border-bottom:1px solid #e0e0e0;
}

/* สีสลับแถว */
.data-table tr:nth-child(even) { background-color:#FFF7E6; }
.data-table tr:nth-child(odd)  { background-color:#ffffff; }

.data-table tr:hover { background-color:#DCEDC8; }

/* ----------------------------------------------------
   MOBILE RESPONSIVE
---------------------------------------------------- */

@media (max-width: 768px) {
    .container {
        max-width: 100%; 
        padding: 18px;
    }

    .header { font-size: 26px; }
    .mascot-img { width:110px; height:110px; }

    .data-table th, .data-table td { 
        padding: 7px; 
        font-size:14px;
    }
}

</style>
</head>

<body>

<div class="container">

    <div class="header-section">
        <img src="unnamed.jpg" alt="Safety Mascot" class="mascot-img">
        <div class="header">Certificate Checker</div>
    </div>

    <div class="search-area">
        <div class="search-bar">
            <input type="text" id="searchInput" class="search-input" placeholder="กรอกชื่อ-นามสกุล เช่น ใจรัก มีสุข">
            <button id="searchButton" class="search-button">ค้นหา</button>
        </div>
        <div id="alertMessage" class="alert-message">โปรดกรอกข้อความที่ต้องการค้นหา</div>
    </div>

    <div id="nameResult" class="result-name"></div>

    <div id="certificateTableContainer" style="display:none;">
        <table class="data-table">
            <thead id="certificateTableHead"></thead>
            <tbody id="certificateTableBody"></tbody>
        </table>
    </div>

    <div id="noResult" class="alert-message" style="display:none; background-color:#FFF8D1; color:#8A6D3B;">
        ไม่พบข้อมูลใบรับรองสำหรับคำค้นหานี้
    </div>

</div>

<script>
const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxNlEn32LapklxyLvDvbB_Y3Aw3g37f6zON69m27qdvlVgY4paoUSaf8i65BerMRmFq/exec";
const COLUMNS_TO_HIDE = ['no','name','company','no.', 'status']; 

const searchInput = document.getElementById('searchInput');
const searchButton = document.getElementById('searchButton');
const alertMessage = document.getElementById('alertMessage');
const nameResult = document.getElementById('nameResult');
const tableContainer = document.getElementById('certificateTableContainer');
const tableHead = document.getElementById('certificateTableHead');
const tableBody = document.getElementById('certificateTableBody');
const noResult = document.getElementById('noResult');

function hideAllResults(){
    alertMessage.style.display='none';
    nameResult.style.display='none';
    tableContainer.style.display='none';
    noResult.style.display='none';
}

async function runSearch(){
    hideAllResults();
    const query = searchInput.value.trim();
    if(!query){ 
        alertMessage.style.display='block'; 
        return; 
    }

    try{
        const res = await fetch(`${GAS_WEB_APP_URL}?name=${encodeURIComponent(query)}`);
        const results = await res.json();

        if(results.length===0){ 
            noResult.style.display='block'; 
            return; 
        }

        const first = results[0];
        nameResult.innerHTML = `Name: <strong>${first.NAME || 'ไม่ระบุ'}</strong> | Company: <strong>${first.COMPANY || 'ไม่ระบุ'}</strong>`;
        nameResult.style.display='block';

        tableHead.innerHTML='';
        tableBody.innerHTML='';

        const headers = Object.keys(first);

        headers.forEach(h=>{
            if(!COLUMNS_TO_HIDE.includes(h.toLowerCase())){
                const th = document.createElement('th');
                th.textContent = h;
                tableHead.appendChild(th);
            }
        });

        results.forEach(row=>{
            const tr = document.createElement('tr');
            headers.forEach(h=>{
                if(!COLUMNS_TO_HIDE.includes(h.toLowerCase())){
                    const td = document.createElement('td');
                    td.textContent = row[h] || '';
                    tr.appendChild(td);
                }
            });
            tableBody.appendChild(tr);
        });

        tableContainer.style.display='block';

    }catch(err){
        alertMessage.textContent='เกิดข้อผิดพลาดในการดึงข้อมูล';
        alertMessage.style.display='block';
        console.error(err);
    }
}

searchButton.addEventListener('click', runSearch);
searchInput.addEventListener('keypress', function(e){ 
    if(e.key==='Enter') runSearch(); 
});
</script>

</body>
</html>
