<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Certificate Checker</title>
<style>
/* ---------------------------------
   BASE STYLES (à¸ªà¸³à¸«à¸£à¸±à¸š PC/Default)
   --------------------------------- */
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin:0; padding:30px; background-color:#F9FBE7; color:#333; }
.container { max-width:800px; margin:0 auto; background-color:#fff; padding:40px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.1); } 

/* â­ à¸„à¸§à¸šà¸„à¸¸à¸¡à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸ªà¹ˆà¸§à¸™à¸«à¸±à¸§à¹à¸¥à¸°à¸Šà¹ˆà¸­à¸‡à¸„à¹‰à¸™à¸«à¸²à¹ƒà¸«à¹‰à¹ƒà¸à¸¥à¹‰à¸à¸±à¸™ â­ */
.header-section { display:flex; align-items:center; justify-content:center; flex-direction:column; margin-bottom:10px; } 

.mascot-container { margin-bottom:10px; }
.mascot-img { width:150px; height:150px; border-radius:50%; border:5px solid #4CAF50; box-shadow:0 4px 10px rgba(0,0,0,0.1); object-fit:cover; }

/* â­ PC: à¸¥à¸”à¸‚à¸™à¸²à¸”à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£ Header (Certificate Checker) à¹€à¸›à¹‡à¸™ 26px â­ */
.header { text-align:center; color:#2E7D32; font-size:26px; font-weight:800; border-bottom:4px solid #4CAF50; padding-bottom:10px; width:100%; max-width:380px; } 

/* â­ à¸„à¸§à¸šà¸„à¸¸à¸¡à¸„à¸§à¸²à¸¡à¸à¸§à¹‰à¸²à¸‡à¸ªà¸¹à¸‡à¸ªà¸¸à¸”à¸‚à¸­à¸‡ Search Area à¹à¸¥à¸°à¸ˆà¸±à¸”à¹ƒà¸«à¹‰à¸­à¸¢à¸¹à¹ˆà¸•à¸£à¸‡à¸à¸¥à¸²à¸‡ â­ */
.search-area { max-width: 450px; margin: 0 auto 10px auto; } 

.search-bar { display:flex; gap:10px; } 
.search-input { flex-grow:1; padding:10px 15px; border:2px solid #ccc; border-radius:10px; font-size:16px; transition:border-color 0.3s; } 
.search-input:focus { border-color:#4CAF50; }
.search-button { background-color:#4CAF50; color:white; padding:10px 20px; border:none; border-radius:10px; cursor:pointer; font-size:16px; font-weight:bold; transition: background-color 0.3s, box-shadow 0.3s; } 
.search-button:hover { background-color:#388E3C; box-shadow:0 6px 12px rgba(0,0,0,0.2); }

.result-name { background-color:#E8F5E9; padding:18px; margin-bottom:25px; border-radius:12px; font-weight:bold; color:#388E3C; border:1px solid #C8E6C9; box-shadow:0 2px 4px rgba(0,0,0,0.05); display:none; }
.alert-message { background-color:#FFE0B2; color:#E65100; padding:15px; margin-top:20px; border-radius:10px; text-align:center; font-weight:bold; display:none; }
.data-table { width:100%; border-collapse:collapse; text-align:left; margin-top:20px; }
.data-table th, .data-table td { padding:15px; border:1px solid #e0e0e0; }
.data-table th { background-color:#f5f5f5; font-weight:bold; color:#495057; }
.data-table tr:nth-child(even) { background-color:#fcfcfc; }
.data-table tr:hover { background-color:#DCEDC8; }
.data-table th:nth-child(3), .data-table td:nth-child(3) { text-align:center; }

/* ğŸ“± MEDIA QUERY (à¸ªà¸³à¸«à¸£à¸±à¸šà¸«à¸™à¹‰à¸²à¸ˆà¸­à¹€à¸¥à¹‡à¸ à¹€à¸Šà¹ˆà¸™ à¹‚à¸—à¸£à¸¨à¸±à¸à¸—à¹Œà¸¡à¸·à¸­à¸–à¸·à¸­) ğŸ“± */
@media (max-width: 600px) {
    /* â­ Mobile: à¸¥à¸”à¸‚à¸™à¸²à¸”à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£ Header (Certificate Checker) à¹€à¸›à¹‡à¸™ 18px â­ */
    .header {
        font-size: 18px;
        max-width: 300px; 
    }
    .container {
        padding: 20px; 
    }
    .search-input, .search-button {
        padding: 8px 12px; 
        font-size: 14px;
    }
    .search-area { 
        max-width: 100%; 
        margin: 0 auto 10px auto; 
    }
}
</style>
</head>
<body>
<div class="container">
Â  <div class="header-section">
Â  Â  <div class="mascot-container">
Â  Â  Â  <img src="unnamed.jpg" alt="Safety Mascot" class="mascot-img">
Â  Â  </div>
Â  Â  <div class="header">Certificate Checker</div>
Â  </div>

Â  <div class="search-area">
Â  Â  <div class="search-bar">
Â  Â  Â  <input type="text" id="searchInput" class="search-input" placeholder="à¸à¸£à¸­à¸à¸Šà¸·à¹ˆà¸­à¹€à¸•à¹‡à¸¡ à¸«à¸£à¸·à¸­à¸Šà¸·à¹ˆà¸­à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™">
Â  Â  Â  <button id="searchButton" class="search-button">Search</button>
Â  Â  Â  
Â  Â  </div>
Â  Â  <div id="alertMessage" class="alert-message">à¹‚à¸›à¸£à¸”à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸²</div>
Â  </div>

Â  <div id="nameResult" class="result-name"></div>

Â  <div id="certificateTableContainer" style="display:none;">
Â  Â  <table class="data-table">
Â  Â  Â  <thead id="certificateTableHead"></thead>
Â  Â  Â  <tbody id="certificateTableBody"></tbody>
Â  Â  </table>
Â  </div>

Â  <div id="noResult" class="alert-message" style="display:none; background-color:#fffae0; color:#856404; border:1px solid #ffbb00;">
Â  Â  à¹„à¸¡à¹ˆà¸à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸šà¸£à¸±à¸šà¸£à¸­à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸³à¸„à¹‰à¸™à¸«à¸²à¸™à¸µà¹‰
Â  </div>
</div>

<script>
const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzplxsTGWTz39mVet6Pw_DMtHgN-nb3S3gtZ9dSpzqJF6J1HcVdWoUH5T4xKrS66XPB/exec";
const COLUMNS_TO_HIDE = ['no','name','company','no.'];

const searchInput = document.getElementById('searchInput');
const searchButton = document.getElementById('searchButton');
const alertMessage = document.getElementById('alertMessage');
const nameResult = document.getElementById('nameResult');
const tableContainer = document.getElementById('certificateTableContainer');
const tableHead = document.getElementById('certificateTableHead');
const tableBody = document.getElementById('certificateTableBody');
const noResult = document.getElementById('noResult');

function hideAllResults(){
Â  alertMessage.style.display='none';
Â  nameResult.style.display='none';
Â  tableContainer.style.display='none';
Â  noResult.style.display='none';
}

async function runSearch(){
Â  hideAllResults();
Â  const query = searchInput.value.trim();
Â  if(!query){ alertMessage.style.display='block'; return; }

Â  try{
Â  Â  const res = await fetch(`${GAS_WEB_APP_URL}?name=${encodeURIComponent(query)}`);
Â  Â  const results = await res.json();

Â  Â  if(results.error){ alertMessage.textContent = results.error; alertMessage.style.display='block'; return; }
Â  Â  if(results.length===0){ noResult.style.display='block'; return; }

Â  Â  const first = results[0];
Â  Â  nameResult.innerHTML = `Name: <strong>${first.NAME || 'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸'}</strong> | Company: <strong>${first.COMPANY || 'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸'}</strong>`;
Â  Â  nameResult.style.display='block';

Â  Â  tableHead.innerHTML='';
Â  Â  tableBody.innerHTML='';
Â  Â  const headers = Object.keys(first);
Â  Â  const trHead = document.createElement('tr');
Â  Â  headers.forEach(h=>{
Â  Â  Â  if(!COLUMNS_TO_HIDE.includes(h.toLowerCase())){
Â  Â  Â  Â  const th = document.createElement('th');
Â  Â  Â  Â  th.textContent = h;
Â  Â  Â  Â  trHead.appendChild(th);
Â  Â  Â  }
Â  Â  });
Â  Â  tableHead.appendChild(trHead);

Â  Â  results.forEach(row=>{
Â  Â  Â  const tr = document.createElement('tr');
Â  Â  Â  headers.forEach(h=>{
Â  Â  Â  Â  if(!COLUMNS_TO_HIDE.includes(h.toLowerCase())){
Â  Â  Â  Â  Â  const td = document.createElement('td');
Â  Â  Â  Â  Â  let cellValue = row[h] || '';

Â  Â  Â  Â  Â  /* â­ à¹€à¸à¸´à¹ˆà¸¡à¸£à¸°à¸šà¸šà¸‚à¸¶à¹‰à¸™à¸ªà¸µà¹à¸”à¸‡à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸‰à¸à¸²à¸°à¸™à¸µà¹‰à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ â­ */
Â  Â  Â  Â  Â  if (cellValue === "à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸—à¸³à¸‡à¸²à¸™à¹ƒà¸™à¸—à¸µà¹ˆà¸­à¸±à¸šà¸­à¸²à¸à¸²à¸¨à¹„à¸”à¹‰") {
Â  Â  Â  Â  Â  Â  Â  td.innerHTML = `<span style="color:red; font-weight:bold;">${cellValue}</span>`;
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  td.textContent = cellValue;
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  tr.appendChild(td);
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  tableBody.appendChild(tr);
Â  Â  });

Â  Â  tableContainer.style.display='block';

Â  }catch(err){
Â  Â  alertMessage.textContent='à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥';
Â  Â  alertMessage.style.display='block';
Â  Â  console.error(err);
Â  }
}

searchButton.addEventListener('click', runSearch);
searchInput.addEventListener('keypress', function(e){ if(e.key==='Enter') runSearch(); });
</script>
</body>
</html>